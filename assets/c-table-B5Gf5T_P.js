import{E as I,o as p,e as b,f as y,v as R,h as e,x as C,F as Ce,d as G,B as J,W as r,c as j,g as S,w as k,i as q,M as D,Q as M,R as T,t as z,j as E,_ as we,U as _e,D as ke,N}from"./index-Cc-lLLcQ.js";const Pe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Se=y("path",{fill:"currentColor",d:"M11 4h2v12l5.5-5.5l1.42 1.42L12 19.84l-7.92-7.92L5.5 10.5L11 16z"},null,-1),$e=[Se];function xe(i,n){return p(),b("svg",Pe,$e)}const Me=I({name:"mdi-arrow-down",render:xe}),Le={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ze=y("path",{fill:"currentColor",d:"M13 20h-2V8l-5.5 5.5l-1.42-1.42L12 4.16l7.92 7.92l-1.42 1.42L13 8z"},null,-1),je=[ze];function Be(i,n){return p(),b("svg",Le,je)}const Ne=I({name:"mdi-arrow-up",render:Be});function De(i){const n=R(window.innerWidth),f=R(n.value<=e(i)),h=()=>{n.value=window.innerWidth,f.value=n.value<=e(i)},a=()=>window.removeEventListener("resize",h);return window.addEventListener("resize",h,{passive:!0}),{width:n,isMobile:f,clean:a}}const ue=new Map;function Fe(i,n,f){const h=C(()=>e(n).length),a=C(()=>Math.max(1,e(i)??h.value)),u=C(()=>Math.ceil(h.value/a.value)),s=R(f?ue.get(f)??0:0),g=C(()=>s.value*a.value),_=C(()=>Math.min(h.value,g.value+a.value));Ce(s,F=>{f&&ue.set(f,F)});const c=C(()=>s.value+1<u.value&&_.value<h.value),d=()=>{c.value&&(s.value+=1)},v=C(()=>s.value>0&&g.value>0);return{current:s,pageLength:u,L:g,R:_,hasNextPage:c,nextPage:d,hasPrePage:v,prePage:()=>{v.value&&(s.value-=1)},goPage:F=>{const V=e(F);0<=V&&V<u.value&&(s.value=V)}}}const Ve=G({name:"CTableColumn",props:{label:String,width:{type:[Number,String]},align:String,center:{type:Boolean,default:!1},sort:Function,mobileHeaderClass:{type:Array,default:[]}},setup(i,{slots:n}){const{align:f,center:h}=J(i),a=["px-3","py-2",f.value==="center"||h.value?"text-center":f.value==="right"?"text-right":"text-left"];return()=>r("td",{class:a},n.default&&n.default(i))}}),Ae={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Re=y("path",{fill:"currentColor",d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6z"},null,-1),Te=[Re];function Ee(i,n){return p(),b("svg",Ae,Te)}const ce=I({name:"mdi-chevron-left",render:Ee}),Ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},He=y("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6z"},null,-1),Oe=[He];function Ue(i,n){return p(),b("svg",Ie,Oe)}const de=I({name:"mdi-chevron-right",render:Ue}),We={key:0,class:"mb-2 grid grid-cols-2 gap-2"},Qe={class:"flex justify-center"},qe=G({__name:"c-table-page",props:{isMobile:{type:Boolean},pageView:{},current:{},first:{},last:{},pageSize:{},nextPage:{type:Function},prePage:{type:Function},goPage:{type:Function}},setup(i){const n=i,{isMobile:f,pageView:h,current:a,first:u,last:s}=J(n),g=C(()=>(h==null?void 0:h.value)??5),_=C(()=>(f==null?void 0:f.value)??!1);return(c,d)=>{const v=j("c-button");return p(),b(M,null,[_.value?(p(),b("div",We,[S(v,{padding:"p-2",onClick:c.prePage,disable:e(a)<=e(u)},{default:k(()=>[S(e(ce))]),_:1},8,["onClick","disable"]),S(v,{padding:"p-2",onClick:c.nextPage,disable:e(a)+1>=e(s)},{default:k(()=>[S(e(de))]),_:1},8,["onClick","disable"])])):q("v-if",!0),y("div",Qe,[_.value?q("v-if",!0):(p(),D(v,{key:0,padding:"p-2",onClick:c.prePage,disable:e(a)<=e(u)},{default:k(()=>[S(e(ce))]),_:1},8,["onClick","disable"])),e(s)-e(u)<=g.value?(p(!0),b(M,{key:1},T(e(s)-e(u),t=>(p(),D(v,{key:t,class:"ml-2",info:t+e(u)===e(a)+1,onClick:B=>c.goPage(t+e(u)-1)},{default:k(()=>[y("span",null,z(t+e(u)),1)]),_:2},1032,["info","onClick"]))),128)):e(a)-e(u)<g.value?(p(),b(M,{key:2},[(p(!0),b(M,null,T(g.value,t=>(p(),D(v,{key:t,class:"ml-2",info:t+e(u)===e(a)+1,onClick:B=>c.goPage(t+e(u)-1)},{default:k(()=>[y("span",null,z(t+e(u)),1)]),_:2},1032,["info","onClick"]))),128)),d[4]||(d[4]=y("span",{class:"select-none ml-2 inline-flex justify-center items-center py-2 md:px-2"},"...",-1)),S(v,{class:"ml-2",onClick:d[0]||(d[0]=t=>c.goPage(e(s)-1))},{default:k(()=>[E(z(e(s)),1)]),_:1})],64)):e(s)-e(a)<=g.value?(p(),b(M,{key:3},[S(v,{class:"ml-2",onClick:d[1]||(d[1]=t=>c.goPage(e(u)))},{default:k(()=>[E(z(e(u)+1),1)]),_:1}),d[5]||(d[5]=y("span",{class:"select-none ml-2 inline-flex justify-center items-center py-2 md:px-2"},"...",-1)),(p(!0),b(M,null,T(g.value,t=>(p(),D(v,{key:t,class:"ml-2",info:e(s)-g.value+t===e(a)+1,onClick:B=>c.goPage(e(s)-g.value+t-1)},{default:k(()=>[y("span",null,z(e(s)-g.value+t),1)]),_:2},1032,["info","onClick"]))),128))],64)):(p(),b(M,{key:4},[S(v,{class:"ml-2",onClick:d[2]||(d[2]=t=>c.goPage(e(u)))},{default:k(()=>[E(z(e(u)+1),1)]),_:1}),d[6]||(d[6]=y("span",{class:"select-none ml-2 inline-flex justify-center items-center py-2 md:px-2"},"...",-1)),(p(!0),b(M,null,T(g.value,t=>(p(),D(v,{key:t,class:"ml-2",info:e(a)-Math.floor(g.value/2)+t===e(a)+1,onClick:B=>c.goPage(e(a)-Math.floor(g.value/2)+t-1)},{default:k(()=>[y("span",null,z(e(a)-Math.floor(g.value/2)+t),1)]),_:2},1032,["info","onClick"]))),128)),d[7]||(d[7]=y("span",{class:"select-none ml-2 inline-flex justify-center items-center py-2 md:px-2"},"...",-1)),S(v,{class:"ml-2",onClick:d[3]||(d[3]=t=>c.goPage(e(s)-1))},{default:k(()=>[E(z(e(s)),1)]),_:1})],64)),_.value?q("v-if",!0):(p(),D(v,{key:5,padding:"p-2",class:"ml-2",onClick:c.nextPage,disable:e(a)+1>=e(s)},{default:k(()=>[S(e(de))]),_:1},8,["onClick","disable"]))])],64)}}}),Ge={},Je={class:"select relative"},Ke={class:"pl-2 pr-8 py-2 cursor-pointer block w-full outline-none rounded border border-1 border-[#dbdbdb] appearance-none"};function Xe(i,n){return p(),b("div",Je,[y("select",Ke,[_e(i.$slots,"default")])])}const Ye=we(Ge,[["render",Xe]]),pe=new Map,et=G({name:"CTable",components:{IconDown:Me,IconUp:Ne,CTablePage:qe,CSelect:Ye},props:{cache:{type:String},data:{type:Array,default:[]},mobile:{type:Number,default:768},defaultSort:{type:String},defaultSortOrder:{type:String,default:"asc"},pageSize:{type:Number},mobilePageSize:{type:Number}},setup(i,{slots:n}){const{data:f,defaultSort:h,defaultSortOrder:a,mobile:u,pageSize:s,mobilePageSize:g}=J(i),_=C(()=>f.value.length===0),{isMobile:c,clean:d}=De(u);ke(()=>d());const v=C(()=>c.value?g.value??s.value:s.value),t=i.cache?pe.get(i.cache):void 0,B=C(()=>N(v.value)),{current:F,pageLength:V,L:H,R:ve,nextPage:fe,prePage:ge,goPage:me}=Fe(v,f,i.cache),A=R((t==null?void 0:t.field)??h.value),L=R((t==null?void 0:t.order)??a.value),O=()=>{i.cache&&pe.set(i.cache,{field:A.value,order:L.value})};O();const K=$=>{A.value=$,L.value=a.value,O()},X=()=>{L.value==="desc"?L.value="asc":L.value="desc",O()},U=$=>{if(!$)return[];const P=[];for(const l of $)if(l.type===M&&Array.isArray(l.children))for(const o of l.children)o!==null&&typeof o=="object"&&!Array.isArray(o)&&P.push(o);else P.push(l);return P.filter(l=>l.type===Ve)},W=U(n.columns?n.columns({}):[]),he=C(()=>(P=>{var l,o;if(N(A.value)){for(const m of W)if((((l=m.props)==null?void 0:l.label)??"")===A.value){const x=P.sort((o=m.props)==null?void 0:o.sort);return L.value==="desc"?x.reverse():x}return P}else return P})(f.value)),Y=C(()=>he.value.slice(H.value,ve.value)),Z=()=>r(j("c-table-page"),{current:F.value,first:0,last:V.value,pageSize:v.value,nextPage:fe,prePage:ge,goPage:me,pageView:c.value?3:5,isMobile:c.value}),be=()=>{const $=()=>W.map(l=>{var ee,te,ne,le,ae,se,oe,re;const o=N((ee=l.props)==null?void 0:ee.sort),m=o&&(((te=l.props)==null?void 0:te.label)??"")===A.value,w={width:(ne=l.props)==null?void 0:ne.width,borderWidth:"0 0 2px 0"},x=((le=l.props)==null?void 0:le.align)==="center"||N((ae=l.props)==null?void 0:ae.center)&&((se=l.props)==null?void 0:se.center)!==!1?"justify-center":((oe=l.props)==null?void 0:oe.align)==="right"?"justify-end":"justify-start";return r("th",{style:w,class:["select-none","font-600","px-3","py-2","border-solid",m?"border-[#7a7a7a]":"border-[#dbdbdb]",o?"cursor-pointer":null,o?"hover:border-[#7a7a7a]":null]},r("div",{class:["flex","items-center",x],onClick:o?()=>{var ie;m?X():K(((ie=l.props)==null?void 0:ie.label)??"")}:void 0},[o?r(L.value==="desc"?j("icon-down"):j("icon-up"),{class:[!m&&"hidden"]}):"",r("span",{},(re=l.props)==null?void 0:re.label)]))}),P=l=>l.map((o,m)=>r("tr",{},n.columns&&U(n.columns({row:o,index:m+H.value}))));return r("div",{},[r("table",{class:["table","w-full","border-separate","table-auto","rounded"]},[r("thead",{},r("tr",{},$())),r("tbody",{},P(Y.value))]),!_.value&&B.value&&Z(),_.value&&n.empty&&n.empty({})])},ye=()=>{const $=()=>{const l=W.map(o=>{var m,w;if(N((m=o.props)==null?void 0:m.sort)){const x=((w=o.props)==null?void 0:w.label)??"";return r("option",{value:x},[x])}else return null}).filter(o=>N(o));return l.length>0&&r("div",{class:["my-4","flex","justify-between"]},[r(j("c-select"),{class:["w-full","mr-2"],onChange(o){var w;const m=(w=o.target)==null?void 0:w.value;N(m)&&K(m)}},l),r(j("c-button"),{info:!0,onClick:X},[L.value==="desc"?r(j("icon-down"),{}):r(j("icon-up"),{})])])},P=()=>Y.value.map((l,o)=>{const m=U(n.columns&&n.columns({row:l,index:o+H.value,mobile:!0}));return r("div",{class:["box","p-0","my-4"]},m.map(w=>{var Q;const x=(w.props&&w.props["mobile-header-class"])??[];return r("div",{class:["pl-3","border","flex","flex-shrink","justify-between","justify-items-stretch"]},[r("div",{class:["py-2","font-600","text-left","flex","items-center",...x]},(Q=w.props)==null?void 0:Q.label),r(w,{class:["block"]})])}))});return r("div",{class:["mobile-table"]},[!_.value&&$(),P(),!_.value&&B.value&&Z(),_.value&&n.empty&&n.empty({})])};return()=>c.value?ye():be()}});export{Ve as C,et as a,Ye as b};
